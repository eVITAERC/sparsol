Starting point: Michael's sparsol code

Forked from Sarsha's version: Mar 2012